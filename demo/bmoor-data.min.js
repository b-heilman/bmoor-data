;(function(){
/** bmoor-data v0.0.1 **/
bMoor.make("bmoor.data.Collection",["bmoor.defer.Group","bmoor.data.Eventable",function(t,o){"use strict";function e(){var t,o;for(bMoor.data.setUid(this),t=0,o=arguments.length;o>t;t++)this.$insert(arguments[t])}return{parent:Array,construct:e,extend:[new o],properties:{_canInsert:function(){return!0},_insert:function(t){bMoor.data.setUid(t),this.$trigger("insert",t)},_canRemove:function(){return!0},_remove:function(t){this.$trigger("remove",t)},concat:function(){var t,o,r=new e;for(r.$follow(this),t=0,o=arguments;o>t;t++)r.push(arguments[t]);return r},push:function(t){t instanceof e?this.$follow(t):this._canInsert(t)&&(Array.prototype.push.call(this,t),this._insert(t))},unshift:function(t){t instanceof e?this.$follow(t):this._canInsert(t)&&(Array.prototype.unshift.call(this,t),this._insert(t))},pop:function(){var t;return this._canRemove()&&(t=Array.prototype.pop.call(this),this._remove(t)),t},shift:function(){var t=Array.prototype.shift.call(this);return this._remove(t),t},slice:function(){var t,o,e=Array.prototype.slice.apply(this,arguments);for(t=0,o=e.length;o>t;t++)this.$remove(e[t]);return new Collection(e)},forEach:function(t,o){var e,r;for(e=0,r=this.length;r>e;e++)t.call(o||this,this[e],e)},$insert:function(t){this.push(t)},$remove:function(t){t instanceof e?this.$ignore(t):this._canRemove(t)&&(bMoor.array.remove(this,t),this._remove(t))},$watch:function(t,o){var e=this.$on("insert",t),r=this.$on("remove",o);return function(){e(),r()}},$follow:function(t){var o,r,n;if(t instanceof e&&(n=bMoor.data.getUid(t),this.$$following||(this.$$following={}),!this.$$following[n])){for(o=0,r=t.length;r>o;o++)this.$insert(t[o]);this.$$following[n]=t.$watch(this.$insert.bind(this),this.$remove.bind(this))}},$ignore:function(t){var o,r,n;if(t instanceof e&&(n=bMoor.data.getUid(t),this.$$following&&!this.$$following[n])){for(o=0,r=t.length;r>o;o++)this.$remove(t[o]);this.$$following[n](),this.$$following[n]=null}},$inflate:function(){var o=new t;return bMoor.loop(this,function(t,e){bMoor.isFunction(t.inflate)&&o.add(t.inflate())}),o.run(),o.promise.then(function(){return data})},$deflate:function(){var o=[],e=new t;return bMoor.loop(this,function(t,r){bMoor.isFunction(t.deflate)?e.add(t.deflate().then(function(t){o[r]=t})):o[r]=t}),e.run(),e.promise.then(function(){return o})}}}}]),bMoor.make("bmoor.data.Eventable",["bmoor.extender.Mixin",function(t){return{parent:t,properties:{$on:function(t,o){return this._$listeners||(this._$listeners={}),this._$listeners[t]||(this._$listeners[t]=[]),this._$listeners[t].push(o),function(){bMoor.array.remove(this.$$listeners[t],o)}},$trigger:function(t,o){var e,r,n;if(this._$listeners&&(e=this._$listeners[t]))for(r=0,n=e.length;n>r;r++)e[r](o)}}}}]),bMoor.make("bmoor.data.Node",["bmoor.data.Eventable",function(t){return{construct:function(t){this.getData=function(){return t}},extend:[new t],properties:{_update:function(t){this.$trigger("update",t)},update:function(t,o){var e;try{o?(bMoor.set(t,o,this.getData()),e=t):bMoor.isFunction(t)?e=t(this.getData()):bMoor.isObject(t)&&(bMoor.object.explode(t,this.getData()),e=bMoor.object.explode(t)),this._update(e)}catch(r){console.log("bmoor.Node:update",r)}},watch:function(t){return this.$on("update",t)},mount:function(t,o){bMoor.set(t,o,this.getData())}}}}]),bMoor.make("bmoor.data.collection.Filterable",["bmoor.extender.Decorator",function(t){"use strict";return{parent:t,construct:function(t){this.$filter=t},properties:{_$extend:function(o){this.$filter&&(o.$filter=this.$filter),t.prototype._$extend.call(this,o)},_canInsert:function(t){return this.$filter(t)?this.$old(t):void 0}}}}]),bMoor.make("bmoor.data.collection.Sortable",["bmoor.extender.Decorator","bmoor.flow.Regulator",function(t,o){return{parent:t,construct:function(t){this.$sorter=t},properties:{_$extend:function(o){this.$sorter&&(o.$sorter=this.$sorter),t.prototype._$extend.call(this,o)},_insert:function(t){return this.$sort||(this.$sort=new o(5,200,function(t){t.$sorter&&t.sort(t.$sorter)})),this.$sort(this),this.$old(t)}}}}]),bMoor.make("bmoor.data.collection.Unique",["bmoor.extender.Decorator","bmoor.data.Collection",function(t,o){"use strict";return{parent:t,properties:{_canInsert:function(t){var o=bMoor.data.setUid(t);return this._$memory||(this._$memory={}),this._$memory[o]?(this._$memory[o]++,!1):this.$old(t)?(this._$memory[o]=1,!0):void 0},_canRemove:function(t){var o=bMoor.data.getUid(t);return this._$memory||(this._$memory={}),this._$memory[o]--,this.$old(t)&&!this._$memory[o]}}}}]);
//# sourceMappingURL=bmoor-data.min.js.map
}());